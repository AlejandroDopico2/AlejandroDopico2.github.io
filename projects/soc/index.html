<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Battery SoC Estimator | Alejandro Dopico-Castro </title> <meta name="author" content="Alejandro Dopico-Castro"> <meta name="description" content="Huawei TechArena 2024 – Nuremberg"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website, computer-science, machine-learning, deep-learning, continual-learning, frugal-artificial-itelligence, frugal-ai, green-ai"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://alejandrodopico2.github.io/projects/soc/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Alejandro</span> Dopico-Castro </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Battery SoC Estimator</h1> <p class="post-description">Huawei TechArena 2024 – Nuremberg</p> </header> <article> <p>Ever wondered how electric vehicles or smartphones know how much battery they have left? Behind that simple percentage lies a complex estimation problem—and solving it well is critical for performance, safety, and reliability.</p> <p>At the <a href="https://www.huawei.com/minisite/techarena2024/" rel="external nofollow noopener" target="_blank"><strong>Huawei TechArena 2024 Hackathon in Nuremberg</strong></a>, my teammates and I faced this challenge. We built an efficient and robust <strong>Machine Learning system</strong> that estimates the <strong>State of Charge (SoC)</strong> of a lithium battery in real time.</p> <hr> <h3 id="-why-soc-estimation-matters">🔋 Why SoC Estimation Matters</h3> <p>The <strong>State of Charge (SoC)</strong> tells you how full a battery is—like a fuel gauge for electricity. But measuring it isn’t as simple as reading a value.</p> <blockquote> <p>There’s no sensor that directly tells you the SoC.</p> </blockquote> <p>Traditionally, estimation relies on physical models or recursive filters that need to “settle” over time. But that’s a problem when conditions are changing fast—like in electric vehicles or IoT sensors, where continuous, accurate readings are crucial.</p> <p>So we asked ourselves:</p> <blockquote> <p>Can we make an SoC estimator that’s <strong>fast</strong>, <strong>accurate</strong>, and <strong>doesn’t depend on convergence</strong>?</p> </blockquote> <hr> <h3 id="️-our-approach-a-two-stage-ml-pipeline-for-clean-estimation">⚙️ Our Approach: A Two-Stage ML Pipeline for Clean Estimation</h3> <p>Our solution, “Real-time Battery State of Charge Estimation: A Non-Autoregressive Machine Learning Approach,” tackled the problem with a novel, two-stage ML pipeline. As computer scientists, not electrical engineers, we observed a crucial insight: while voltage and SoC are inherently linked, the raw voltage readings from sensors are often “dirty”—heavily influenced by <strong>current</strong> (charging/discharging) and <strong>temperature</strong>. These factors introduce noise, making direct SoC prediction unreliable.</p> <p>To address this, our core idea was to first <strong>clean the noisy voltage signal</strong> before estimating the SoC. This approach allowed us to leverage the strong, almost direct relationship between a <em>clean</em> voltage and the battery’s true state of charge.</p> <p>We focused on <strong>tree-based ensemble models</strong> (XGBoost, LightGBM, CatBoost) for both stages due to their:</p> <ul> <li> <strong>Speed and Efficiency:</strong> Lightweight enough for embedded systems.</li> <li> <strong>Robustness:</strong> Surprisingly resilient to noisy real-world data.</li> <li> <strong>Performance:</strong> Often more efficient than deep learning methods for this type of real-time prediction.</li> </ul> <p>Our system operates in two main phases:</p> <ol> <li> <strong>Offline Training Phase:</strong> This involved extensive cross-validation, Bayesian optimization for hyperparameter tuning, and careful engineering of features to create highly performant and generalized models for both the voltage cleaner and SoC estimator.</li> <li> <strong>Online Inference Phase:</strong> This phase focused on sub-millisecond predictions, ensuring real-time performance across both stages of our pipeline.</li> </ol> <hr> <h3 id="-stage-1-the-voltage-cleaner-module">🧠 Stage 1: The Voltage Cleaner Module</h3> <p>Our first critical step was to obtain a “clean” representation of the battery’s voltage. Raw voltage readings are significantly affected by the <strong>current</strong> flowing through the battery (which can momentarily increase or decrease voltage) and <strong>temperature</strong>.</p> <p>To filter out this “noise,” we developed a dedicated <strong>Voltage Cleaner module</strong>, itself an ML model trained using tree-based ensembles. This module takes recent sensor readings (raw voltage, current, and temperature) and, through advanced feature engineering, learns to predict what the voltage <em>would be</em> if these external influences were minimized.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/soc/cleaner-480.webp 480w,/assets/img/projects/soc/cleaner-800.webp 800w,/assets/img/projects/soc/cleaner-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/projects/soc/cleaner.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Voltage Cleaner" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Example output of our Voltage Cleaner module, showing how it denoises raw sensor voltage to reveal the underlying, "clean" voltage signal. </div> <hr> <h3 id="-stage-2-soc-estimation-from-clean-voltage">🧠 Stage 2: SoC Estimation from Clean Voltage</h3> <p>Once we had a cleaner voltage signal, the task of SoC estimation became much more direct and robust. The output from our Voltage Cleaner module, along with other relevant features, fed into our main <strong>SoC Estimator model</strong>.</p> <p>This second tree-based model then efficiently and accurately predicts the battery’s State of Charge in real time. By decoupling the noise from the core voltage signal, we achieved highly stable and reliable SoC estimates, even under rapidly changing battery conditions.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/soc/inference_results-480.webp 480w,/assets/img/projects/soc/inference_results-800.webp 800w,/assets/img/projects/soc/inference_results-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/projects/soc/inference_results.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="SoC Estimator" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Example output of our SoC Estimator module, showing how it predicts the battery's State of Charge in real time. </div> <hr> <h3 id="️-feature-engineering-from-raw-data-to-actionable-insights">⚙️ Feature Engineering: From Raw Data to Actionable Insights</h3> <p>For both the Voltage Cleaner and the SoC Estimator, we engineered rich features using <strong>sliding windows</strong> (typical in time series analysis) over:</p> <ul> <li>Recent <strong>voltage</strong>, <strong>current</strong>, and <strong>temperature</strong> readings.</li> <li>Statistical aggregations like mean, min, max, and standard deviation to capture temporal patterns and trends.</li> </ul> <hr> <h3 id="-real-time-performance-instant-reliable-estimates">🚀 Real-Time Performance: Instant, Reliable Estimates</h3> <p>The real magic of our system lies in its real-time performance. It operates seamlessly, even on standard commodity laptops.</p> <p>Just feed it new battery data, and it instantly returns SoC estimates—no warm-up, no wait, making it highly suitable for <strong>real-world Battery Management Systems (BMS)</strong> integration. Our system achieved <strong>&lt;1ms prediction latency</strong> and <strong>&lt;1MB model size</strong>, crucial metrics for edge deployment.</p> <hr> <h3 id="-full-workflow">🔄 Full Workflow</h3> <p>Here’s how our non-autoregressive ML system seamlessly integrates the two stages to provide real-time SoC estimates:</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/soc/diagram-480.webp 480w,/assets/img/projects/soc/diagram-800.webp 800w,/assets/img/projects/soc/diagram-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/projects/soc/diagram.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="SoC Estimator" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Our two-stage ML pipeline for real-time battery SoC estimation. Sensor data is first processed by the Voltage Cleaner, and its output then feeds into the SoC Estimator. </div> <ol> <li> <strong>Collect Battery Data:</strong> Raw voltage, current, and temperature readings are continuously collected from sensors.</li> <li> <strong>Voltage Cleaner Input &amp; Prediction:</strong> Features are extracted from this raw data, and our dedicated Voltage Cleaner model predicts a “clean” voltage signal.</li> <li> <strong>SoC Estimator Input &amp; Prediction:</strong> The clean voltage, along with other statistical features from raw data, are fed into the SoC Estimator model, which instantly predicts the State of Charge.</li> <li> <strong>Log Predictions:</strong> Predictions and relevant metrics are logged in real time for monitoring and analysis.</li> </ol> <hr> <h3 id="-evaluation">🧪 Evaluation</h3> <p>We rigorously validated our system across <strong>multiple usage scenarios</strong>, simulating various devices and operating conditions. The results consistently demonstrated <strong>strong generalization</strong>, providing accurate predictions even on entirely unseen battery profiles.</p> <p>Through comprehensive cross-validation and automated hyperparameter tuning, we ensured our models avoided overfitting, giving us high confidence in their robustness and reliability in diverse real-world applications.</p> <hr> <h3 id="-tech-stack">📦 Tech Stack</h3> <ul> <li>Python 3.10</li> <li>XGBoost / LightGBM / CatBoost (for core ML models in both stages)</li> <li>Scikit-learn &amp; Optuna (for model training and Bayesian optimization)</li> <li>Loguru (for efficient logging)</li> </ul> <hr> <h3 id="-second-place-at-huawei-techarena-2024">🏆 Second Place at Huawei TechArena 2024</h3> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/soc/image1-480.webp 480w,/assets/img/projects/soc/image1-800.webp 800w,/assets/img/projects/soc/image1-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/projects/soc/image1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" alt="Me during the Huawei TechArena 2024 finals in Nuremberg" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Me during the Huawei TechArena 2024 finals in Nuremberg. </div> <p>This project was part of a unique and intense competition organized by <strong>Huawei</strong> in collaboration with <strong>BeMyApp</strong>. It was a multi-stage hackathon, spanning several months, culminating in an on-site final in Nuremberg, Germany.</p> <p>My teammates, <a href="https://www.linkedin.com/in/abel-juncal-su%C3%A1rez-52b86a240/" rel="external nofollow noopener" target="_blank"><strong>Abel Juncal Suárez</strong></a> and <a href="https://www.linkedin.com/in/jorge-paz-ruza-646141186" rel="external nofollow noopener" target="_blank"><strong>Jorge Paz Ruza</strong></a>, and I formed a team. We were thrilled to secure <strong>second place</strong> among many talented teams!</p> <p>The competition unfolded in distinct phases:</p> <ul> <li> <strong>Initial Online Phase (2 months):</strong> We developed foundational algorithms with initial datasets.</li> <li> <strong>Refinement Online Phase:</strong> We further optimized our algorithms with more data.</li> <li> <strong>On-Site Finals in Nuremberg:</strong> We presented our solution, performed real-time predictions with new data, and competed against other finalists at Huawei’s headquarters.</li> </ul> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/soc/image2-480.webp 480w,/assets/img/projects/soc/image2-800.webp 800w,/assets/img/projects/soc/image2-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/projects/soc/image2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" alt="Team 8 receiving second place award at Huawei TechArena 2024" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Team 8 receiving second place award at Huawei TechArena 2024. </div> <hr> <h3 id="-final-thoughts">🏁 Final Thoughts</h3> <p>This project was a deep dive into building an ML system that truly <strong>needs to work in the real world</strong>—on the edge, in real time, with imperfect signals. It highlighted that successful machine learning isn’t just about achieving high accuracy in a lab setting; it’s equally about <strong>latency, reliability, and generalizability</strong>.</p> <p>The experience of competing in the Huawei TechArena 2024, collaborating with my teammates, and ultimately securing second place, was incredibly rewarding. It reinforced the importance of practical considerations in ML development and showed me just how much impact can be packed into a few hundred milliseconds of optimized Python code.</p> <hr> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Alejandro Dopico-Castro. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: July 04, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>